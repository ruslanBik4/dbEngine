// Code generated by qtc from "database_tpl.qtpl". DO NOT EDIT.
// See https://github.com/valyala/quicktemplate for details.

//line database_tpl.qtpl:1
package _go

//line database_tpl.qtpl:2
import (
	"fmt"

	"github.com/iancoleman/strcase"
	"github.com/ruslanBik4/dbEngine/dbEngine"
	"github.com/ruslanBik4/dbEngine/dbEngine/psql"
)

//line database_tpl.qtpl:12
import (
	qtio422016 "io"

	qt422016 "github.com/valyala/quicktemplate"
)

//line database_tpl.qtpl:12
var (
	_ = qtio422016.Copy
	_ = qt422016.AcquireByteBuffer
)

//line database_tpl.qtpl:12
func (c *Creator) StreamCreateDatabase(qw422016 *qt422016.Writer, listRoutines []string) {
//line database_tpl.qtpl:12
	qw422016.N().S(`
// Code generated by dbEngine-gen-go. DO NOT EDIT!
// versions:
// 	dbEngine v1.1.6
// source: %s %s

package db

import (
	"fmt"
	"time"
	"strings"
`)
//line database_tpl.qtpl:24
	for _, lib := range c.packages {
//line database_tpl.qtpl:24
		qw422016.N().S(`"`)
//line database_tpl.qtpl:24
		qw422016.E().S(lib)
//line database_tpl.qtpl:24
		qw422016.N().S(`"
`)
//line database_tpl.qtpl:25
	}
//line database_tpl.qtpl:25
	qw422016.N().S(`
	"github.com/jackc/pgconn"

	"github.com/ruslanBik4/logs"
	"github.com/ruslanBik4/dbEngine/dbEngine"
    "github.com/ruslanBik4/dbEngine/dbEngine/psql"

	"golang.org/x/net/context"
	"github.com/pkg/errors"
)
`)
//line database_tpl.qtpl:36
	for name, typ := range c.db.Types {
//line database_tpl.qtpl:36
		c.StreamCreateTypeInterface(qw422016, typ, strcase.ToCamel(name), name, c.Types[name])
//line database_tpl.qtpl:36
	}
//line database_tpl.qtpl:36
	qw422016.N().S(`
// Database is root interface for operation for %s.%s
type Database struct {
	*dbEngine.DB
	CreateAt time.Time
}
// NewDatabase create new Database with minimal necessary handlers
func NewDatabase(ctx context.Context, noticeHandler pgconn.NoticeHandler, channelHandler pgconn.NotificationHandler, channels ...string) (*Database, error) {
	if noticeHandler == nil {
		noticeHandler = printNotice
	}
	conn := psql.NewConn(nil, nil, noticeHandler, channels...)
	if channelHandler != nil {
		conn.ChannelHandler = channelHandler
	}

	DB, err := dbEngine.NewDB(ctx, conn)
	if err != nil {
		logs.ErrorLog(err, "")
		return nil, err
	}

	return &Database{DB, time.Now()}, nil
}
// PsqlConn return connection as *psql.Conn
// need for some low-level operation,
// invoke Conn.Select...(custom sql),
//        New{table_name}FromConn, etc.
func (d *Database) PsqlConn() *psql.Conn {
	return (d.Conn).(*psql.Conn)
}
`)
//line database_tpl.qtpl:68
	for name := range c.db.Tables {
//line database_tpl.qtpl:68
		c.StreamCreateTableConstructor(qw422016, strcase.ToCamel(name), name)
//line database_tpl.qtpl:68
	}
//line database_tpl.qtpl:69
	for _, name := range listRoutines {
//line database_tpl.qtpl:69
		c.StreamCreateRoutinesInvoker(qw422016, c.db.Routines[name].(*psql.Routine), name)
//line database_tpl.qtpl:69
	}
//line database_tpl.qtpl:69
	qw422016.N().S(`// printNotice logging some psql messages (invoked command 'RAISE ...')
func printNotice(c *pgconn.PgConn, n *pgconn.Notice) {

	switch {
    case n.Code == "42P07" || strings.Contains(n.Message, "skipping") :
		logs.DebugLog("skip operation: %%s", n.Message)

	case n.Severity == "INFO" :
		logs.StatusLog(n.Message)

	case n.Code > "00000" :
		err := (*pgconn.PgError)(n)
		logs.CustomLog(logs.CRITICAL, "DB_EXEC",  err.File, int(err.Line),
			fmt.Sprintf("%v, hint: %s, where: %s, %s %s", err, n.Hint, n.Where,  err.SQLState(), err.Routine), logs.FgErr)

	case strings.HasPrefix(n.Message, "[[ERROR]]") :
		logs.ErrorLog(errors.New(strings.TrimPrefix(n.Message, "[[ERROR]]") + n.Severity))

	default: // DEBUG
		logs.DebugLog("%+v %s (PID:%d)", n.Severity, n.Message, c.PID())
	}
}
`)
//line database_tpl.qtpl:92
}

//line database_tpl.qtpl:92
func (c *Creator) WriteCreateDatabase(qq422016 qtio422016.Writer, listRoutines []string) {
//line database_tpl.qtpl:92
	qw422016 := qt422016.AcquireWriter(qq422016)
//line database_tpl.qtpl:92
	c.StreamCreateDatabase(qw422016, listRoutines)
//line database_tpl.qtpl:92
	qt422016.ReleaseWriter(qw422016)
//line database_tpl.qtpl:92
}

//line database_tpl.qtpl:92
func (c *Creator) CreateDatabase(listRoutines []string) string {
//line database_tpl.qtpl:92
	qb422016 := qt422016.AcquireByteBuffer()
//line database_tpl.qtpl:92
	c.WriteCreateDatabase(qb422016, listRoutines)
//line database_tpl.qtpl:92
	qs422016 := string(qb422016.B)
//line database_tpl.qtpl:92
	qt422016.ReleaseByteBuffer(qb422016)
//line database_tpl.qtpl:92
	return qs422016
//line database_tpl.qtpl:92
}

//line database_tpl.qtpl:94
func (c *Creator) StreamCreateTypeInterface(qw422016 *qt422016.Writer, t dbEngine.Types, typeName, name, typeCol string) {
//line database_tpl.qtpl:95
	if len(t.Enumerates) > 0 {
//line database_tpl.qtpl:96
	} else {
//line database_tpl.qtpl:96
		qw422016.N().S(`// `)
//line database_tpl.qtpl:97
		qw422016.E().S(typeName)
//line database_tpl.qtpl:97
		qw422016.N().S(` create new instance of type `)
//line database_tpl.qtpl:97
		qw422016.E().S(name)
//line database_tpl.qtpl:97
		qw422016.N().S(`
type `)
//line database_tpl.qtpl:98
		qw422016.E().S(typeName)
//line database_tpl.qtpl:98
		qw422016.N().S(` struct {
`)
//line database_tpl.qtpl:99
		for _, tAttr := range t.Attr {
//line database_tpl.qtpl:99
			qw422016.N().S(`	`)
//line database_tpl.qtpl:100
			qw422016.N().S(fmt.Sprintf("%-21s\t%-13s\t", strcase.ToCamel(tAttr.Name), tAttr.Type))
//line database_tpl.qtpl:100
			qw422016.N().S(` `)
//line database_tpl.qtpl:100
			qw422016.N().S("`")
//line database_tpl.qtpl:100
			qw422016.N().S(`json:"`)
//line database_tpl.qtpl:100
			qw422016.E().S(tAttr.Name)
//line database_tpl.qtpl:100
			qw422016.N().S(`"`)
//line database_tpl.qtpl:100
			qw422016.N().S("`")
//line database_tpl.qtpl:100
			qw422016.N().S(`
`)
//line database_tpl.qtpl:101
		}
//line database_tpl.qtpl:101
		qw422016.N().S(`}

func (dst *`)
//line database_tpl.qtpl:104
		qw422016.E().S(typeName)
//line database_tpl.qtpl:104
		qw422016.N().S(`) DecodeText(ci *pgtype.ConnInfo, src []byte) error {
	if len(src) == 0 {
		*dst = `)
//line database_tpl.qtpl:106
		qw422016.E().S(typeName)
//line database_tpl.qtpl:106
		qw422016.N().S(`{}
		return nil
	}
	srcPart := bytes.Split(src[1:len(src)-1], []byte(","))
    *dst = `)
//line database_tpl.qtpl:110
		qw422016.E().S(typeName)
//line database_tpl.qtpl:110
		qw422016.N().S(`{
`)
//line database_tpl.qtpl:111
		for i, tAttr := range t.Attr {
//line database_tpl.qtpl:111
			qw422016.N().S(`		`)
//line database_tpl.qtpl:112
			qw422016.N().S(c.GetFuncForDecode(tAttr.Name, tAttr.Type, i))
//line database_tpl.qtpl:112
			qw422016.N().S(`,
`)
//line database_tpl.qtpl:113
			i++

//line database_tpl.qtpl:114
		}
//line database_tpl.qtpl:114
		qw422016.N().S(`	}

	return nil
}
`)
//line database_tpl.qtpl:119
	}
//line database_tpl.qtpl:120
}

//line database_tpl.qtpl:120
func (c *Creator) WriteCreateTypeInterface(qq422016 qtio422016.Writer, t dbEngine.Types, typeName, name, typeCol string) {
//line database_tpl.qtpl:120
	qw422016 := qt422016.AcquireWriter(qq422016)
//line database_tpl.qtpl:120
	c.StreamCreateTypeInterface(qw422016, t, typeName, name, typeCol)
//line database_tpl.qtpl:120
	qt422016.ReleaseWriter(qw422016)
//line database_tpl.qtpl:120
}

//line database_tpl.qtpl:120
func (c *Creator) CreateTypeInterface(t dbEngine.Types, typeName, name, typeCol string) string {
//line database_tpl.qtpl:120
	qb422016 := qt422016.AcquireByteBuffer()
//line database_tpl.qtpl:120
	c.WriteCreateTypeInterface(qb422016, t, typeName, name, typeCol)
//line database_tpl.qtpl:120
	qs422016 := string(qb422016.B)
//line database_tpl.qtpl:120
	qt422016.ReleaseByteBuffer(qb422016)
//line database_tpl.qtpl:120
	return qs422016
//line database_tpl.qtpl:120
}

//line database_tpl.qtpl:122
func (c *Creator) StreamCreateRoutinesInvoker(qw422016 *qt422016.Writer, r *psql.Routine, name string) {
//line database_tpl.qtpl:124
	camelName := strcase.ToCamel(name)
	args := make([]any, len(r.Params()))
	sql, _, _ := r.BuildSql(dbEngine.ArgsForSelect(args...))
	typeReturn := ""

//line database_tpl.qtpl:129
	if r.Type == psql.ROUTINE_TYPE_PROC {
//line database_tpl.qtpl:129
		qw422016.N().S(`// `)
//line database_tpl.qtpl:130
		qw422016.E().S(camelName)
//line database_tpl.qtpl:130
		qw422016.N().S(` call procedure '`)
//line database_tpl.qtpl:130
		qw422016.E().S(name)
//line database_tpl.qtpl:130
		qw422016.N().S(`'
// DB comment: '`)
//line database_tpl.qtpl:131
		qw422016.E().S(r.Comment)
//line database_tpl.qtpl:131
		qw422016.N().S(`'
func (d *Database) `)
//line database_tpl.qtpl:132
		qw422016.E().S(camelName)
//line database_tpl.qtpl:132
		qw422016.N().S(`(ctx context.Context,
				`)
//line database_tpl.qtpl:133
		c.streamparamsTitle(qw422016, r)
//line database_tpl.qtpl:133
		qw422016.N().S(`
) error {
	return d.Conn.ExecDDL(ctx,
				`)
//line database_tpl.qtpl:133
		qw422016.N().S("`")
//line database_tpl.qtpl:136
		qw422016.E().S(sql)
//line database_tpl.qtpl:136
		qw422016.N().S(``)
//line database_tpl.qtpl:136
		qw422016.N().S("`")
//line database_tpl.qtpl:136
		qw422016.N().S(`,
				`)
//line database_tpl.qtpl:137
		c.streamparamsArgs(qw422016, r)
//line database_tpl.qtpl:137
		qw422016.N().S(`
			)
}
`)
//line database_tpl.qtpl:140
	} else {
//line database_tpl.qtpl:141
		switch len(r.Columns()) {
//line database_tpl.qtpl:142
		case 0:
//line database_tpl.qtpl:143
			typeReturn = c.udtToReturnType(r.UdtName)

//line database_tpl.qtpl:144
		case 1:
//line database_tpl.qtpl:146
			param := r.Columns()[0]
			typeReturn, _ = c.chkTypes(param, strcase.ToCamel(param.Name()))

//line database_tpl.qtpl:149
		default:
//line database_tpl.qtpl:150
			typeReturn = fmt.Sprintf("*%sRowScanner", camelName)

//line database_tpl.qtpl:151
			c.StreamCreateRowScanner(qw422016, r, camelName)
//line database_tpl.qtpl:151
			qw422016.N().S(`
`)
//line database_tpl.qtpl:152
		}
//line database_tpl.qtpl:152
		qw422016.N().S(`// `)
//line database_tpl.qtpl:153
		qw422016.E().S(camelName)
//line database_tpl.qtpl:153
		qw422016.N().S(` run query with select DB function '`)
//line database_tpl.qtpl:153
		qw422016.E().S(name)
//line database_tpl.qtpl:153
		qw422016.N().S(`: `)
//line database_tpl.qtpl:153
		qw422016.E().S(r.UdtName)
//line database_tpl.qtpl:153
		qw422016.N().S(`'
// DB comment: '`)
//line database_tpl.qtpl:154
		qw422016.E().S(r.Comment)
//line database_tpl.qtpl:154
		qw422016.N().S(`'
// ATTENTION! It returns only 1 row `)
//line database_tpl.qtpl:155
		qw422016.E().S(typeReturn)
//line database_tpl.qtpl:155
		qw422016.N().S(`
func (d *Database) `)
//line database_tpl.qtpl:156
		qw422016.E().S(camelName)
//line database_tpl.qtpl:156
		qw422016.N().S(`(ctx context.Context,
				`)
//line database_tpl.qtpl:157
		c.streamparamsTitle(qw422016, r)
//line database_tpl.qtpl:157
		qw422016.N().S(`
) (res `)
//line database_tpl.qtpl:158
		qw422016.E().S(typeReturn)
//line database_tpl.qtpl:158
		qw422016.N().S(`, err error) {
	err = d.Conn.SelectOneAndScan(ctx,
				&res,
				`)
//line database_tpl.qtpl:158
		qw422016.N().S("`")
//line database_tpl.qtpl:161
		qw422016.E().S(sql)
//line database_tpl.qtpl:161
		qw422016.N().S(`
				FETCH FIRST 1 ROW ONLY`)
//line database_tpl.qtpl:161
		qw422016.N().S("`")
//line database_tpl.qtpl:161
		qw422016.N().S(`,
				`)
//line database_tpl.qtpl:163
		c.streamparamsArgs(qw422016, r)
//line database_tpl.qtpl:163
		qw422016.N().S(`
			)

	return
}
`)
//line database_tpl.qtpl:168
		if r.ReturnType() == "record" {
//line database_tpl.qtpl:168
			qw422016.N().S(`// `)
//line database_tpl.qtpl:169
			qw422016.E().S(camelName)
//line database_tpl.qtpl:169
			qw422016.N().S(`Each run query with select DB function '`)
//line database_tpl.qtpl:169
			qw422016.E().S(name)
//line database_tpl.qtpl:169
			qw422016.N().S(`'
// DB comment: '`)
//line database_tpl.qtpl:170
			qw422016.E().S(r.Comment)
//line database_tpl.qtpl:170
			qw422016.N().S(`'
// each will get every row from `)
//line database_tpl.qtpl:171
			qw422016.E().S(camelName)
//line database_tpl.qtpl:171
			qw422016.N().S(`sRowScanner
func (d *Database) `)
//line database_tpl.qtpl:172
			qw422016.E().S(camelName)
//line database_tpl.qtpl:172
			qw422016.N().S(`Each(ctx context.Context,
	each func(record *`)
//line database_tpl.qtpl:173
			qw422016.E().S(camelName)
//line database_tpl.qtpl:173
			qw422016.N().S(`RowScanner) error,
	`)
//line database_tpl.qtpl:174
			c.streamparamsTitle(qw422016, r)
//line database_tpl.qtpl:174
			qw422016.N().S(`
) error {
	res := &`)
//line database_tpl.qtpl:176
			qw422016.E().S(camelName)
//line database_tpl.qtpl:176
			qw422016.N().S(`RowScanner{}
	err := d.Conn.SelectAndScanEach(ctx,
				func () error {
					defer func () {
					//	create new record
						res = &`)
//line database_tpl.qtpl:181
			qw422016.E().S(camelName)
//line database_tpl.qtpl:181
			qw422016.N().S(`RowScanner{}
					}()

					if each != nil {
						return each(res)
					}
					return nil
				},
				res,
				`)
//line database_tpl.qtpl:181
			qw422016.N().S("`")
//line database_tpl.qtpl:190
			qw422016.E().S(sql)
//line database_tpl.qtpl:190
			qw422016.N().S(``)
//line database_tpl.qtpl:190
			qw422016.N().S("`")
//line database_tpl.qtpl:190
			qw422016.N().S(`,
				`)
//line database_tpl.qtpl:191
			c.streamparamsArgs(qw422016, r)
//line database_tpl.qtpl:191
			qw422016.N().S(`
		)
	return err
}
`)
//line database_tpl.qtpl:195
		}
//line database_tpl.qtpl:195
		qw422016.N().S(`
`)
//line database_tpl.qtpl:196
	}
//line database_tpl.qtpl:196
	qw422016.N().S(`
`)
//line database_tpl.qtpl:197
}

//line database_tpl.qtpl:197
func (c *Creator) WriteCreateRoutinesInvoker(qq422016 qtio422016.Writer, r *psql.Routine, name string) {
//line database_tpl.qtpl:197
	qw422016 := qt422016.AcquireWriter(qq422016)
//line database_tpl.qtpl:197
	c.StreamCreateRoutinesInvoker(qw422016, r, name)
//line database_tpl.qtpl:197
	qt422016.ReleaseWriter(qw422016)
//line database_tpl.qtpl:197
}

//line database_tpl.qtpl:197
func (c *Creator) CreateRoutinesInvoker(r *psql.Routine, name string) string {
//line database_tpl.qtpl:197
	qb422016 := qt422016.AcquireByteBuffer()
//line database_tpl.qtpl:197
	c.WriteCreateRoutinesInvoker(qb422016, r, name)
//line database_tpl.qtpl:197
	qs422016 := string(qb422016.B)
//line database_tpl.qtpl:197
	qt422016.ReleaseByteBuffer(qb422016)
//line database_tpl.qtpl:197
	return qs422016
//line database_tpl.qtpl:197
}

//line database_tpl.qtpl:199
func (c *Creator) StreamCreateRowScanner(qw422016 *qt422016.Writer, r *psql.Routine, camelName string) {
//line database_tpl.qtpl:199
	qw422016.N().S(`// `)
//line database_tpl.qtpl:200
	qw422016.E().S(camelName)
//line database_tpl.qtpl:200
	qw422016.N().S(`RowScanner run query with select
type `)
//line database_tpl.qtpl:201
	qw422016.E().S(camelName)
//line database_tpl.qtpl:201
	qw422016.N().S(`RowScanner struct {
`)
//line database_tpl.qtpl:202
	for _, param := range r.Columns() {
//line database_tpl.qtpl:204
		s := strcase.ToCamel(param.Name())
		typeCol, _ := c.chkTypes(param, s)

//line database_tpl.qtpl:206
		qw422016.N().S(`	`)
//line database_tpl.qtpl:207
		qw422016.E().S(s)
//line database_tpl.qtpl:207
		qw422016.N().S(` `)
//line database_tpl.qtpl:207
		qw422016.E().S(typeCol)
//line database_tpl.qtpl:207
		qw422016.N().S(`
`)
//line database_tpl.qtpl:208
	}
//line database_tpl.qtpl:208
	qw422016.N().S(`}
// GetFields implement dbEngine.RowScanner interface
func (r *`)
//line database_tpl.qtpl:211
	qw422016.E().S(camelName)
//line database_tpl.qtpl:211
	qw422016.N().S(`RowScanner) GetFields(columns []dbEngine.Column) []any {
	v := make([]any, len(columns))
	for i, col := range columns {
		switch col.Name() {
`)
//line database_tpl.qtpl:215
	for _, param := range r.Columns() {
//line database_tpl.qtpl:215
		qw422016.N().S(`		case "`)
//line database_tpl.qtpl:216
		qw422016.E().S(param.Name())
//line database_tpl.qtpl:216
		qw422016.N().S(`":
			v[i] =  &r.`)
//line database_tpl.qtpl:217
		qw422016.N().S(strcase.ToCamel(param.Name()))
//line database_tpl.qtpl:217
		qw422016.N().S(`
`)
//line database_tpl.qtpl:218
	}
//line database_tpl.qtpl:218
	qw422016.N().S(`		}
	}

	return v
}
`)
//line database_tpl.qtpl:224
}

//line database_tpl.qtpl:224
func (c *Creator) WriteCreateRowScanner(qq422016 qtio422016.Writer, r *psql.Routine, camelName string) {
//line database_tpl.qtpl:224
	qw422016 := qt422016.AcquireWriter(qq422016)
//line database_tpl.qtpl:224
	c.StreamCreateRowScanner(qw422016, r, camelName)
//line database_tpl.qtpl:224
	qt422016.ReleaseWriter(qw422016)
//line database_tpl.qtpl:224
}

//line database_tpl.qtpl:224
func (c *Creator) CreateRowScanner(r *psql.Routine, camelName string) string {
//line database_tpl.qtpl:224
	qb422016 := qt422016.AcquireByteBuffer()
//line database_tpl.qtpl:224
	c.WriteCreateRowScanner(qb422016, r, camelName)
//line database_tpl.qtpl:224
	qs422016 := string(qb422016.B)
//line database_tpl.qtpl:224
	qt422016.ReleaseByteBuffer(qb422016)
//line database_tpl.qtpl:224
	return qs422016
//line database_tpl.qtpl:224
}

//line database_tpl.qtpl:226
func (c *Creator) streamparamsTitle(qw422016 *qt422016.Writer, r *psql.Routine) {
//line database_tpl.qtpl:227
	for _, param := range r.Params() {
//line database_tpl.qtpl:229
		s := strcase.ToLowerCamel(param.Name())
		typeCol, _ := c.chkTypes(param, s)

//line database_tpl.qtpl:231
		qw422016.N().S(`	`)
//line database_tpl.qtpl:232
		qw422016.E().S(s)
//line database_tpl.qtpl:232
		qw422016.N().S(` `)
//line database_tpl.qtpl:232
		qw422016.E().S(typeCol)
//line database_tpl.qtpl:232
		qw422016.N().S(`,
`)
//line database_tpl.qtpl:233
	}
//line database_tpl.qtpl:234
}

//line database_tpl.qtpl:234
func (c *Creator) writeparamsTitle(qq422016 qtio422016.Writer, r *psql.Routine) {
//line database_tpl.qtpl:234
	qw422016 := qt422016.AcquireWriter(qq422016)
//line database_tpl.qtpl:234
	c.streamparamsTitle(qw422016, r)
//line database_tpl.qtpl:234
	qt422016.ReleaseWriter(qw422016)
//line database_tpl.qtpl:234
}

//line database_tpl.qtpl:234
func (c *Creator) paramsTitle(r *psql.Routine) string {
//line database_tpl.qtpl:234
	qb422016 := qt422016.AcquireByteBuffer()
//line database_tpl.qtpl:234
	c.writeparamsTitle(qb422016, r)
//line database_tpl.qtpl:234
	qs422016 := string(qb422016.B)
//line database_tpl.qtpl:234
	qt422016.ReleaseByteBuffer(qb422016)
//line database_tpl.qtpl:234
	return qs422016
//line database_tpl.qtpl:234
}

//line database_tpl.qtpl:235
func (c *Creator) streamparamsArgs(qw422016 *qt422016.Writer, r *psql.Routine) {
//line database_tpl.qtpl:236
	for _, param := range r.Params() {
//line database_tpl.qtpl:236
		qw422016.N().S(`	`)
//line database_tpl.qtpl:237
		qw422016.E().S(strcase.ToLowerCamel(param.Name()))
//line database_tpl.qtpl:237
		qw422016.N().S(`,
`)
//line database_tpl.qtpl:238
	}
//line database_tpl.qtpl:239
}

//line database_tpl.qtpl:239
func (c *Creator) writeparamsArgs(qq422016 qtio422016.Writer, r *psql.Routine) {
//line database_tpl.qtpl:239
	qw422016 := qt422016.AcquireWriter(qq422016)
//line database_tpl.qtpl:239
	c.streamparamsArgs(qw422016, r)
//line database_tpl.qtpl:239
	qt422016.ReleaseWriter(qw422016)
//line database_tpl.qtpl:239
}

//line database_tpl.qtpl:239
func (c *Creator) paramsArgs(r *psql.Routine) string {
//line database_tpl.qtpl:239
	qb422016 := qt422016.AcquireByteBuffer()
//line database_tpl.qtpl:239
	c.writeparamsArgs(qb422016, r)
//line database_tpl.qtpl:239
	qs422016 := string(qb422016.B)
//line database_tpl.qtpl:239
	qt422016.ReleaseByteBuffer(qb422016)
//line database_tpl.qtpl:239
	return qs422016
//line database_tpl.qtpl:239
}

//line database_tpl.qtpl:241
func (c *Creator) StreamCreateTableConstructor(qw422016 *qt422016.Writer, cName, name string) {
//line database_tpl.qtpl:241
	qw422016.N().S(`// New`)
//line database_tpl.qtpl:242
	qw422016.E().S(cName)
//line database_tpl.qtpl:242
	qw422016.N().S(` create new instance of table `)
//line database_tpl.qtpl:242
	qw422016.E().S(cName)
//line database_tpl.qtpl:242
	qw422016.N().S(`
func (d *Database) New`)
//line database_tpl.qtpl:243
	qw422016.E().S(cName)
//line database_tpl.qtpl:243
	qw422016.N().S(`(ctx context.Context) (*`)
//line database_tpl.qtpl:243
	qw422016.E().S(cName)
//line database_tpl.qtpl:243
	qw422016.N().S(`, error) {
	const name = "`)
//line database_tpl.qtpl:244
	qw422016.E().S(name)
//line database_tpl.qtpl:244
	qw422016.N().S(`"
	table, ok := d.Tables[name]
    if !ok {
		var err error
		table, err = New`)
//line database_tpl.qtpl:248
	qw422016.E().S(cName)
//line database_tpl.qtpl:248
	qw422016.N().S(`FromConn(ctx, d.PsqlConn())
		if err != nil {
			return nil, err
		}
		d.Tables[name] = table
    }

    return &`)
//line database_tpl.qtpl:255
	qw422016.E().S(cName)
//line database_tpl.qtpl:255
	qw422016.N().S(`{
		Table: table.(*psql.Table),
    }, nil
}
`)
//line database_tpl.qtpl:259
}

//line database_tpl.qtpl:259
func (c *Creator) WriteCreateTableConstructor(qq422016 qtio422016.Writer, cName, name string) {
//line database_tpl.qtpl:259
	qw422016 := qt422016.AcquireWriter(qq422016)
//line database_tpl.qtpl:259
	c.StreamCreateTableConstructor(qw422016, cName, name)
//line database_tpl.qtpl:259
	qt422016.ReleaseWriter(qw422016)
//line database_tpl.qtpl:259
}

//line database_tpl.qtpl:259
func (c *Creator) CreateTableConstructor(cName, name string) string {
//line database_tpl.qtpl:259
	qb422016 := qt422016.AcquireByteBuffer()
//line database_tpl.qtpl:259
	c.WriteCreateTableConstructor(qb422016, cName, name)
//line database_tpl.qtpl:259
	qs422016 := string(qb422016.B)
//line database_tpl.qtpl:259
	qt422016.ReleaseByteBuffer(qb422016)
//line database_tpl.qtpl:259
	return qs422016
//line database_tpl.qtpl:259
}
